"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9797],{59797:(T,y,i)=>{i.r(y),i.d(y,{MakePaymentPageModule:()=>A});var h=i(54463),d=i(36895),p=i(24006),o=i(48058),u=i(64228),c=i(22727),t=i(98274),g=i(53025),P=i(33038),S=i(43485),f=i(9999),M=i(42599);const D=[{path:"",component:(()=>{class n{constructor(s,a,r,e,l,N,v){this.utils=s,this.putPaymentResults=a,this.translate=r,this.config=e,this.logger=l,this.directDebitService=N,this.router=v,this.transactionType="SALE",this.paymentDescription="Premium Payment",this.paymentGateway="https://pay.e-ghl.com/IPGSG/Payment.aspx",this.isPaymentSuccess=!1,this.alertButtons=[{text:this.translate.instant("make_payment.okBtn"),handler:()=>{this.router.navigate(["payment-acknowledgement"],{state:{successdata:this.paymentSuccessResp,animate:!0,direction:"forward"}})}}],this.config.currentPage.pageName="MakePaymentPage",this.encryptedPolicyNo=history.state.encryptedPolicyNo,this.merchantURL=history.state.mURL,this.merchantReturnURL=history.state.mreturnURL,this.merchantID=history.state.ID,this.password=history.state.passwd,this.merchantName=history.state.mname,this.paymentUserData=history.state.paymentdata,this.isDirectDebit=history.state.isDirectDebit,this.isDirectDebit?(this.transactionType="EMANDATE01",this.paymentDescription="Direct Debit peyment",this.premiumAmount=1,this.paymentGateway=this.merchantURL):this.premiumAmount=this.paymentUserData.premium,this.policyNo=this.paymentUserData.policyNumber,this.policyOwnerName=this.paymentUserData.policyOwner,this.phone=this.paymentUserData.contactNumber,this.planName=this.paymentUserData.planName,this.email=this.paymentUserData.email,this.paymentId=this.paymentUserData.paymentid,this.isPaymentSuccess=!1}pay(){var a=(window.crypto.getRandomValues(new Uint16Array(1))[0]+1e4).toString();eGHL.makePayment({CurrencyCode:"MYR",PymtMethod:"ANY",TransactionType:this.transactionType,PaymentGateway:"https://pay.e-ghl.com/IPGSG/Payment.aspx",ServiceID:this.merchantID,Password:this.password,PaymentID:this.paymentId,OrderNumber:a,PaymentDesc:"Premium payment",MerchantReturnURL:this.merchantReturnURL,Amount:this.premiumAmount,CustIP:"172.17.68.38",CustName:this.policyOwnerName,CustEmail:this.email,CustPhone:this.phone,MerchantName:this.merchantName,LanguageCode:"EN",PageTimeout:"780",PaymentTimeout:"-1",sdkTimeout:"780",_finaliseMessage:"Optional message for Finalising Payment (iOS Only)",_cancelMessage:"Optional message for Cancelling Payment (iOS Only)"},e=>{0==e.TxnStatus?(this.utils.presentToast(this.translate.instant("make_payment.paymentSuccess")),this.isPaymentSuccess=!0,this.paymentSuccessResp={transactionType:e.TransactionType||"",pymtMethod:e.PymtMethod||"",serviceID:e.ServiceID||"",paymentID:e.PaymentID||"",currencyCode:e.CurrencyCode||"",txnID:e.TxnID||"",issuingBank:e.IssuingBank||"",txnStatus:e.TxnStatus||"",authCode:e.AuthCode||"",cardHolder:e.CardHolder||"",cardNoMask:e.CardNoMask||"",cardExp:e.CardExp||"",cardType:e.CardType||"",premiumAmount:e.Amount||"",txnMessage:e.TxnMessage||""}):1==e.TxnStatus?(this.isPaymentSuccess=!0,this.paymentSuccessResp={transactionType:e.TransactionType||"",pymtMethod:e.PymtMethod||"",serviceID:e.ServiceID||"",paymentID:e.PaymentID||"",currencyCode:e.CurrencyCode||"",txnID:e.TxnID||"",issuingBank:e.IssuingBank||"",txnStatus:e.TxnStatus||"",authCode:e.AuthCode||"",cardHolder:e.CardHolder||"",cardNoMask:e.CardNoMask||"",cardExp:e.CardExp||"",cardType:e.CardType||"",premiumAmount:e.Amount||"",txnMessage:e.TxnMessage||""},this.utils.showAlert(this.translate.instant("make_payment.paymentFailed"),this.translate.instant("make_payment.transactionFailed"),!1,this.alertButtons)):this.utils.showAlert(this.translate.instant("make_payment.paymentFailed"),this.translate.instant("make_payment.transactionFailed"),!1,this.alertButtons)},e=>{this.utils.showAlert(this.translate.instant("make_payment.paymentFailed"),this.translate.instant("make_payment.transactionFailed"),!1,this.alertButtons)})}paymentSuccess(){if(this.utils.isDeviceOnLine())this.utils.showProgressLoader(),this.isDirectDebit?this.directDebitService.putEMandateResults(this.paymentSuccessResp,this.paymentSeqNo).then(s=>{try{if(this.utils.dissmisProgressLoader(),s.responseJSON)if(s.responseJSON.statusCode==c.yI||s.responseJSON.statusCode==c.OK){let a=s.responseJSON.userMessage||this.translate.instant("make_payment.paymentSuccessService");this.utils.showAlert("",a,!1,this.alertButtons)}else{let a=s.responseJSON.Message||this.translate.instant("make_payment.paymentSuccessService");this.utils.showAlert("",a,!1,this.alertButtons)}}catch(a){this.utils.dissmisProgressLoader(),this.logger.error("loginSuccess catch eror : "+JSON.stringify(a));let r=this.translate.instant("make_payment.tryAgain");this.utils.showAlert("",r,!1,this.alertButtons)}},s=>{let a;this.utils.dissmisProgressLoader(),a=this.utils.handleServiceException(s),this.utils.showAlert("",a,!1,this.alertButtons)}):this.putPaymentResults.putPaymentSuccessDetails(this.paymentSuccessResp,this.paymentSeqNo).then(s=>{try{if(this.utils.dissmisProgressLoader(),s.responseJSON)if(s.responseJSON.statusCode==c.yI||s.responseJSON.statusCode==c.OK){let a=s.responseJSON.userMessage||this.translate.instant("make_payment.paymentSuccessService");this.utils.showAlert("",a,!1,this.alertButtons)}else{let a=s.responseJSON.Message||this.translate.instant("make_payment.paymentSuccessService");this.utils.showAlert("",a,!1,this.alertButtons)}}catch(a){this.utils.dissmisProgressLoader(),this.logger.error("loginSuccess catch eror : "+JSON.stringify(a));let r=this.translate.instant("make_payment.tryAgain");this.utils.showAlert("",r,!1,this.alertButtons)}},s=>{let a;this.utils.dissmisProgressLoader(),a=this.utils.handleServiceException(s),this.utils.showAlert("",a,!1,this.alertButtons)});else{this.utils.dissmisProgressLoader();let s=this.translate.instant("generic_msgs.network_err");this.utils.showAlert("",s,!1,this.alertButtons)}}}return n.\u0275fac=function(s){return new(s||n)(t.Y36(g.f),t.Y36(P.B),t.Y36(h.sK),t.Y36(S.i),t.Y36(f.U),t.Y36(M.G),t.Y36(u.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-make-payment"]],decls:14,vars:11,consts:[["mode","ios"],["color","primary"],["slot","start"],["text","","icon","chevron-back-outline",2,"padding-left","15px","font-size","0.7rem"],[1,"bold-font"],["no-bounce","",1,"ion-padding"],["ion-button","","full","",3,"disabled","click"]],template:function(s,a){1&s&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),t._UZ(3,"ion-back-button",3),t.qZA(),t.TgZ(4,"ion-title",4),t._uU(5),t.ALo(6,"translate"),t.qZA()()(),t.TgZ(7,"ion-content",5)(8,"button",6),t.NdJ("click",function(){return a.pay()}),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"button",6),t.NdJ("click",function(){return a.paymentSuccess()}),t._uU(12),t.ALo(13,"translate"),t.qZA()()),2&s&&(t.xp6(5),t.Oqu(t.lcZ(6,5,"make_payment.title")),t.xp6(3),t.Q6J("disabled",a.isPaymentSuccess),t.xp6(1),t.Oqu(t.lcZ(10,7,"make_payment.pay")),t.xp6(2),t.Q6J("disabled",!a.isPaymentSuccess),t.xp6(1),t.Oqu(t.lcZ(13,9,"make_payment.send_data")))},dependencies:[o.oU,o.Sm,o.W2,o.Gu,o.wd,o.sr,o.cs,h.X$]}),n})()}];let k=(()=>{class n{}return n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.Bz.forChild(D),u.Bz]}),n})(),A=(()=>{class n{}return n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez,p.u5,o.Pc,h.aw,k]}),n})()}}]);