"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8418],{78418:(U,m,n)=>{n.r(m),n.d(m,{LoginFirstPageModule:()=>M});var h=n(36895),g=n(24006),s=n(48058),d=n(64228),p=n(43485),c=n(22727),f=n(65414),e=n(98274),O=n(9999),P=n(53025),S=n(61390),u=n(54463),_=n(42008),N=n(15342),F=n(85059),v=n(6615);function b(i,l){1&i&&(e.TgZ(0,"div")(1,"span",22),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"Login.userName_req")))}function J(i,l){1&i&&(e.TgZ(0,"div")(1,"span",22),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"Login.email_req")))}function L(i,l){1&i&&(e.TgZ(0,"div")(1,"span",23),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"Login.TandM_req")))}const C=[{path:"",component:(()=>{class i{constructor(t,o,r,a,x,T,D,k,Z,y,A,w){this.router=t,this.formBuilder=o,this.menuControl=r,this.logger=a,this.utils=x,this.loginService=T,this.translate=D,this.config=k,this.faio=Z,this.jsonStore=y,this.profileService=A,this.mediaReleaseService=w,this.errorLogattemt=0}ionViewDidEnter(){this.menuControl.enable(!0,"first"),this.utils.component.emit(f.c.LOGIN)}ngOnInit(){this.login_terms=!0,this.initializeForm(),this.showFingerPrintPopup=history.state.showFingerPrint,this.showFingerPrintPopup&&this.showBioMetricPopup()}initializeForm(){this.loginFormFirst=this.formBuilder.group({username:["",[g.kI.required,g.kI.pattern(p.i.EMAIL_PATTERN)]],loginTerms:[{value:!0,disabled:!1}]})}showBioMetricPopup(){setTimeout(()=>{this.faio.show({title:"SunAccess",subtitle:"Biometric Authentication",description:"Please authenticate",fallbackButtonTitle:"Use Backup",disableBackup:!0}).then(t=>{this.touchIDValidate()},t=>{console.log("touch id not valida try again")}).catch(t=>{console.log("catch error touch id "+t)})},500)}getSecureWordforUser(t){this.utils.showProgressLoader(),this.loginService.getSecurePhrase(t).then(r=>{try{if(this.utils.dissmisProgressLoader(),r.responseJSON&&r.responseJSON.statusCode==c.OK){this.config.secureWordImage="data:image/jpeg;base64,"+r.responseJSON.image;let a={usernameFromFirstLogin:this.loginFormFirst.controls.username.value.trim()};this.router.navigate(["/login"],{state:{usernameId:a}}),this.loginFormFirst.controls.username.reset(),this.loginFormFirst.controls.username.setValue(null)}}catch(a){this.utils.dissmisProgressLoader(),this.logger.error("loginSuccess catch eror : "+JSON.stringify(a))}},r=>{this.utils.dissmisProgressLoader();let a=this.utils.handleServiceException(r);this.utils.showAlert("",a)})}navigateToSecondLoginPage(){let t=this.loginFormFirst.controls.username.value.trim();this.getSecureWordforUser(t)}checkboxChange(t){this.login_terms=!!t.detail.checked}touchIDValidate(){this.logger.trace("FirstLoginPage--touchIDValidate--start");let t=this.config.passCodeInfo.userName,o=this.utils.getDeviceId(),r=this.config.passCodeInfo.passCodeToken.replace(/[$@]/g,"");this.logger.trace("touch id before calling adapter userID : "+t+" deviceID : "+o+" token :"+r),this.utils.isDeviceOnLine()?(this.utils.showProgressLoader(),this.loginService.userLogin(t,r,o).then(a=>{this.loginSuccess(a)},a=>{this.errorLogattemt=this.errorLogattemt+1,1==this.errorLogattemt?this.touchIDValidate():(this.utils.dissmisProgressLoader(),this.utils.presentToast(this.translate.instant("passscode_page.passcode_error")),this.logger.error("touch id login failure error "+JSON.stringify(a)))})):this.utils.presentToast(this.translate.instant("generic_msgs.network_err")),this.logger.trace("FirstLoginPage--touchIDValidate--end")}loginSuccess(t){this.logger.trace("loginPage--loginSuccess--start"),this.logger.debug("loginSuccess-"+t);try{t.responseJSON&&t.responseJSON.statusCode==c.OK?(this.config.userInfo.encryptedUserId=t.responseJSON.encrypted_user_id,this.config.userInfo.token=t.responseJSON.token_type+" "+t.responseJSON.access_token,"YES"==t.responseJSON.force_change_password.toUpperCase()?this.config.userInfo.forceChangePassword=t.responseJSON.force_change_password:(this.config.userInfo.expiresIn=t.responseJSON.expires_in,this.config.userInfo.userId=t.responseJSON.userId,this.config.userInfo.name=t.responseJSON.name,this.config.userInfo.email=t.responseJSON.email,this.config.userInfo.identityNumber=t.responseJSON.identity_number,this.config.userInfo.contactNumber=t.responseJSON.contact_number,this.config.userInfo.role=t.responseJSON.role,this.config.userInfo.forceChangeSecureWord=t.responseJSON.force_secure_phrase,this.config.userInfo.lastLoginDate=t.responseJSON.last_login_date,this.config.userInfo.issued=t.responseJSON.issued,this.config.userInfo.expires=t.responseJSON.expires,this.config.userInfo.unreadNoti=t.responseJSON.unread_notifications,this.utils.publishSomeData({user:"UnreadNotiUpdated",data:this.config.userInfo.unreadNoti}),this.config.userInfo.notification_subs_prompt=t.responseJSON.notification_subscription_prompt,this.config.userInfo.subscribedNotitags=t.responseJSON.notification_subscriptions,this.config.userInfo.showPasswordExpirationMsgFlag=t.responseJSON.password_change_reminder,this.config.userInfo.passwordReminderMsg=t.responseJSON.password_reminder_message,this.refreshToken=t.responseJSON.refresh_token.trim(),this.config.userInfo.maskedContactNumber=t.responseJSON.contact_number.replace(/\d(?=\d{4})/g,"*"),null!=this.config.sessionTimeout&&(clearTimeout(this.config.sessionTimeout),this.config.sessionTimeout=null),this.jsonStore.addDataToJsonStore(this.jsonStore.collectionNames.refreshToken,{refreshToken:this.refreshToken}),this.getProfileDetails())):(this.utils.dissmisProgressLoader(),this.utils.showAlert("",t.responseJSON.error_description))}catch(o){this.utils.dissmisProgressLoader(),this.logger.error("loginSuccess catch eror : "+JSON.stringify(o))}this.logger.trace("loginPage--loginSuccess--end")}getProfileDetails(){this.profileService.getProfileDetails().then(t=>{t.responseJSON&&t.responseJSON.statusCode==c.OK&&(this.config.userDetails.name=t.responseJSON.name,this.config.userDetails.birthDate=t.responseJSON.birthDate.trim(),this.config.userDetails.nationality=t.responseJSON.nationality.trim(),this.config.userDetails.race=t.responseJSON.race.trim(),this.config.userDetails.maritalStatus=t.responseJSON.maritalStatus.trim(),this.config.userDetails.addressField1=t.responseJSON.addressField1.trim(),this.config.userDetails.addressField2=t.responseJSON.addressField2.trim(),this.config.userDetails.addressField3=t.responseJSON.addressField3.trim(),this.config.userDetails.addressField4=t.responseJSON.addressField4.trim(),this.config.userDetails.addressField5=t.responseJSON.addressField5.trim(),this.config.userDetails.email=t.responseJSON.email.trim(),this.config.userDetails.homePhone=t.responseJSON.homePhone.trim(),this.config.userDetails.mobilePhone=t.responseJSON.mobilePhone.trim(),this.config.userDetails.officePhone=t.responseJSON.officePhone.trim(),this.config.userDetails.identityNumber=t.responseJSON.identityNo.trim(),this.config.userDetails.profilePicture="data:image/jpeg;base64,"+t.responseJSON.profilePicture,1==this.config.userInfo.forceChangeSecureWord?(this.utils.dissmisProgressLoader(),this.router.navigate(["/update-secure-word"],{state:{animate:!0,direction:"forward",gotoDashboard:"true"}})):(this.utils.dissmisProgressLoader(),this.router.navigate(["/dashboard-after-login"],{state:{animate:!0,direction:"forward",comingFromLoginFlag:{comingFromLogin:!0}}})))},t=>{this.utils.dissmisProgressLoader();let o=this.utils.handleServiceException(t);this.utils.presentToast(o),this.router.navigate(["/login-first"],{state:{animate:!0,direction:"forward"}})})}openTNC(){this.router.navigate(["/termsnconditions"])}register(){this.router.navigate(["/sign-up"])}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(d.F0),e.Y36(g.qu),e.Y36(s._q),e.Y36(O.U),e.Y36(P.f),e.Y36(S.r),e.Y36(u.sK),e.Y36(p.i),e.Y36(_.h),e.Y36(N.D),e.Y36(F.y),e.Y36(v.p))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-login-first"]],decls:40,vars:27,consts:[["mode","ios"],["color","primary",1,"toolbar"],["slot","start","auto-hide","false","color","secondary"],[1,"bold-font"],["forceOverscroll","false",1,"app_bg1","text_color_base"],[1,"UserimgDiv"],[1,"welcome_txt"],[2,"margin-top","-5%"],[1,"margin_bottom",3,"formGroup"],[1,"white_container_border_radius","formPadding"],[1,"marg-area"],["lines","none",1,"border",2,"margin-top","10px"],["formControlName","username","type","email",1,"input-style",3,"placeholder"],[4,"ngIf"],[1,"terms_conditions","flex"],["size","1"],["mode","md","formControlName","loginTerms",1,"margin_top_bottom_auto",3,"checked","ionChange"],["size","11"],[1,"terms",3,"click"],[1,"btn_center",2,"--border-radius","10px !important",3,"disabled","click"],[1,"login_link"],[3,"click"],[1,"fail"],[1,"fail","padding_015"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1),e._UZ(2,"ion-menu-button",2),e.TgZ(3,"ion-title",3),e._uU(4,"Login"),e.qZA()()(),e.TgZ(5,"ion-content",4)(6,"div",5)(7,"p",6),e._uU(8),e.ALo(9,"translate"),e._UZ(10,"br"),e._uU(11),e.ALo(12,"translate"),e.qZA()(),e.TgZ(13,"div",7)(14,"form",8)(15,"div",9)(16,"div",10)(17,"ion-item",11),e._UZ(18,"ion-input",12),e.ALo(19,"translate"),e.qZA(),e.YNc(20,b,4,3,"div",13),e.YNc(21,J,4,3,"div",13),e.TgZ(22,"ion-row",14)(23,"ion-col",15)(24,"ion-checkbox",16),e.NdJ("ionChange",function(a){return o.checkboxChange(a)}),e.qZA()(),e.TgZ(25,"ion-col",17)(26,"span"),e._uU(27),e.ALo(28,"translate"),e.TgZ(29,"span",18),e.NdJ("click",function(){return o.openTNC()}),e._uU(30),e.ALo(31,"translate"),e.qZA()()()(),e.YNc(32,L,4,3,"div",13),e.TgZ(33,"ion-button",19),e.NdJ("click",function(){return o.navigateToSecondLoginPage()}),e._uU(34),e.ALo(35,"translate"),e.qZA()()()(),e.TgZ(36,"div",20)(37,"span",21),e.NdJ("click",function(){return o.register()}),e._uU(38),e.ALo(39,"translate"),e.qZA()()()()),2&t&&(e.xp6(8),e.Oqu(e.lcZ(9,13,"welcome")),e.xp6(3),e.Oqu(e.lcZ(12,15,"sunacces")),e.xp6(3),e.Q6J("formGroup",o.loginFormFirst),e.xp6(4),e.s9C("placeholder",e.lcZ(19,17,"emailid")),e.xp6(2),e.Q6J("ngIf",o.loginFormFirst.get("username").hasError("required")&&o.loginFormFirst.get("username").dirty),e.xp6(1),e.Q6J("ngIf",!o.loginFormFirst.get("username").hasError("required")&&o.loginFormFirst.get("username").hasError("pattern")&&o.loginFormFirst.get("username").dirty),e.xp6(3),e.Q6J("checked",o.login_terms),e.xp6(3),e.hij("",e.lcZ(28,19,"terms_conditions_accept")," "),e.xp6(3),e.Oqu(e.lcZ(31,21,"terms_and_conditions")),e.xp6(2),e.Q6J("ngIf",!1===o.loginFormFirst.controls.loginTerms.value&&o.loginFormFirst.get("loginTerms").touched),e.xp6(1),e.Q6J("disabled",!o.loginFormFirst.controls.username.valid||!o.login_terms),e.xp6(1),e.Oqu(e.lcZ(35,23,"login")),e.xp6(4),e.Oqu(e.lcZ(39,25,"newuser")))},dependencies:[h.O5,g._Y,g.JJ,g.JL,s.YG,s.nz,s.wI,s.W2,s.Gu,s.pK,s.Ie,s.fG,s.Nd,s.wd,s.sr,s.w,s.j9,g.sg,g.u,u.X$],styles:[".app_bg1[_ngcontent-%COMP%]{--background: url(register_bg.35962209e77bb744.jpg) no-repeat center center / cover;background-size:cover;background-repeat:no-repeat;height:100%;background-position:bottom}.list-header[_ngcontent-%COMP%]{margin-bottom:0!important}.item[_ngcontent-%COMP%]{padding-left:0;background:transparent}.item[_ngcontent-%COMP%]   .item-input.ng-valid.item-input-has-value[_ngcontent-%COMP%]:not(.input-has-focus):not(.item-input-has-focus)   .item-inner[_ngcontent-%COMP%], .item.item-input.ng-valid.input-has-value[_ngcontent-%COMP%]:not(.input-has-focus):not(.item-input-has-focus)   .item-inner[_ngcontent-%COMP%]{border-bottom-color:none!important;box-shadow:none!important}.item-inner[_ngcontent-%COMP%]{padding-right:0!important;border-bottom:none!important}.input[_ngcontent-%COMP%]{border:1px solid #eee;background:white}.label[_ngcontent-%COMP%]{color:#002d3d!important;white-space:pre-line}.welcome_txt[_ngcontent-%COMP%]{text-align:center;color:#002d3d;font-size:2rem!important;line-height:35px;margin:15%!important}.item-inner[_ngcontent-%COMP%]{border-bottom:none!important}.input[_ngcontent-%COMP%]{border:1px solid #eee;margin:0}.marg-area[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:medium none;padding:0 15px;width:100%;border-bottom:0px solid #e5e5e5}.item-md.item-block[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%]{padding-right:0}.formPadding[_ngcontent-%COMP%]{padding:22px;margin:12px}.ion-checkBox[_ngcontent-%COMP%]{padding:0 0 0 20px;background:transparent}.ion-checkBox[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{padding:3px 0 0;font-size:1.4rem!important;margin:0}.login_link[_ngcontent-%COMP%]{margin:5px 0;text-align:center;color:#002d3d;font-size:1.1rem}.margin_bottom[_ngcontent-%COMP%]{margin-bottom:10%}.fail[_ngcontent-%COMP%]{text-align:start!important;color:red!important;font-size:.9rem!important}.padding_015[_ngcontent-%COMP%]{padding:0 15px}.terms[_ngcontent-%COMP%]{text-decoration:underline;text-transform:lowercase}.terms_conditions[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-top:5px;font-size:.9rem;font-family:Agenda-Light}.canvas_background[_ngcontent-%COMP%]{text-align:center;background-color:#002d3d;color:#fff}.SecurePhrace_div[_ngcontent-%COMP%]{margin-bottom:-20px}.SecurePhrace_Img[_ngcontent-%COMP%]{margin:auto}.secondLoginDiv[_ngcontent-%COMP%]{margin-top:-30px}.white_container_border_radius[_ngcontent-%COMP%]{background-color:rgba(255,255,255,.7)!important;border-radius:15px!important}.flex[_ngcontent-%COMP%]{display:flex;align-items:center}"]}),i})()}];let I=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[d.Bz.forChild(C),d.Bz]}),i})(),M=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[h.ez,g.u5,s.Pc,u.aw,g.UX,I]}),i})()}}]);