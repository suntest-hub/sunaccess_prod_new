"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2987],{92987:(D,m,a)=>{a.r(m),a.d(m,{NotificationsPageModule:()=>J});var g=a(36895),_=a(24006),o=a(48058),h=a(64228),x=a(65414),f=a(22727),d=a(43485),t=a(98274),N=a(90589),P=a(53025),S=a(95536),M=a(45340),u=a(54463),v=a(9999);function C(e,r){1&e&&(t.TgZ(0,"section",8),t._UZ(1,"ion-spinner",9),t.qZA())}function O(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(i);const s=t.oxw(2);return t.KtG(s.getNotifications(void 0))}),t._uU(1),t.ALo(2,"translate"),t.qZA()}2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"generic_msgs.try_again")))}function y(e,r){if(1&e&&(t.TgZ(0,"section",10)(1,"span"),t._uU(2),t.qZA(),t.YNc(3,O,3,3,"button",11),t.qZA()),2&e){const i=t.oxw();t.xp6(2),t.Oqu(i.errorMsg),t.xp6(1),t.Q6J("ngIf",i.canTryAgain)}}const b=function(e,r){return{customCardUnread:e,customCardRead:r}},T=function(e){return{UnreadNotification:e}};function I(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"ion-item-sliding",14,17)(2,"ion-item",18),t.NdJ("click",function(){const c=t.CHM(i).$implicit,l=t.oxw(2);return t.KtG(l.navToDetails(c))}),t.TgZ(3,"ion-row",19)(4,"ion-col",20)(5,"p"),t._uU(6),t._UZ(7,"br"),t.TgZ(8,"span",21),t._uU(9),t.qZA(),t._UZ(10,"br"),t.TgZ(11,"span",21),t._uU(12),t.qZA()()(),t.TgZ(13,"ion-col",22),t._uU(14),t.qZA()()(),t.TgZ(15,"ion-item-options",23)(16,"ion-button",24),t.NdJ("click",function(){const c=t.CHM(i).$implicit,l=t.MAs(1),p=t.oxw(2);return t.KtG(p.askToDelete(l,c))}),t.TgZ(17,"div"),t._UZ(18,"ion-icon",25)(19,"br"),t.TgZ(20,"ion-label",26),t._uU(21,"DELETE"),t.qZA()()()()()}if(2&e){const i=r.$implicit,n=t.oxw(2);t.xp6(2),t.Q6J("ngClass",t.WLB(6,b,!0===i.unread,!1===i.unread)),t.xp6(4),t.hij("",n.setDay(i.date)," "),t.xp6(3),t.Oqu(n.setMonth(i.date)),t.xp6(3),t.Oqu(n.setYear(i.date)),t.xp6(1),t.Q6J("ngClass",t.VKq(9,T,!0===i.unread)),t.xp6(1),t.hij(" ",i.title," ")}}function w(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"ion-infinite-scroll",27),t.NdJ("ionInfinite",function(s){t.CHM(i);const c=t.oxw(2);return t.KtG(c.getMoreNotifications(s))}),t._UZ(1,"ion-infinite-scroll-content"),t.qZA()}}function Z(e,r){if(1&e&&(t.TgZ(0,"div",13)(1,"ion-list",14),t.YNc(2,I,22,11,"ion-item-sliding",15),t.qZA(),t.YNc(3,w,2,0,"ion-infinite-scroll",16),t.qZA()),2&e){const i=t.oxw();t.xp6(2),t.Q6J("ngForOf",i.notifications),t.xp6(1),t.Q6J("ngIf",!i.isLastPageReached)}}const A=[{path:"",component:(()=>{class e{constructor(i,n,s,c,l,p,L,R,Y,k,E,z){this.router=i,this.detailsService=n,this.menu=s,this.utils=c,this.config=l,this.notificationsService=p,this.translate=L,this.translateService=R,this.logger=Y,this.platform=k,this.ref=E,this.alertCtrl=z,this.notifications=[],this.isShowingLoader=!0,this.canTryAgain=!1,this.isServiceCallInProgress=!1,this.isLastPageReached=!1,this.hasRecords=!0,this.pageNum=1,this.isSuccess=!1,this.utils.analytics("Notifications"),this.config.currentPage.pageName="NotificationsPage",console.log("notifications",this.notifications)}ngOnInit(){this.logger.log("ionViewDidLoad NotificationsPage"),this.month_names_short=this.config.months,this.getNotifications(void 0)}ionViewWillEnter(){this.utils.component.emit(x.c.NOTIFICATIONS)}getNotifications(i){if(this.utils.isDeviceOnLine()){if(this.pageNum<=this.lastPageIndex)return;this.lastPageIndex=this.pageNum,this.isServiceCallInProgress=!0,this.hasRecords=!0,null==i&&(this.canTryAgain=!1,this.isShowingLoader=!0,this.errorMsg=""),this.notificationsService.getNotificationsList(this.pageNum).then(n=>{try{this.notifications.length>0?this.notifications=this.notifications.concat(n.responseJSON.array):(this.notifications=n.responseJSON.array,d.i.PAGE_SIZE=n.responseJSON.pageSize),this.isServiceCallInProgress=!1,this.notifications.length>0||null==i&&(this.canTryAgain=!1,this.errorMsg=this.translateService.instant("generic_msgs.no_data")),n.responseJSON.array.length<d.i.PAGE_SIZE?(this.isLastPageReached=!0,i&&i.enable(!1)):this.pageNum++,null!=i?i.complete():this.isShowingLoader=!1}catch(s){this.isServiceCallInProgress=!1,null==i?(this.isShowingLoader=!1,this.canTryAgain=!0,this.errorMsg=this.translateService.instant("generic_msgs.error_err")):i.complete()}},n=>{this.isServiceCallInProgress=!1,null==i?(this.isShowingLoader=!1,this.canTryAgain=!0,this.errorMsg=this.utils.handleServiceException(n)):i.complete()})}else this.isServiceCallInProgress=!1,null==i?(this.isShowingLoader=!1,this.canTryAgain=!0,this.errorMsg=this.translateService.instant("generic_msgs.network_err")):i.complete()}navToDetails(i){2===i.type?(this.router.navigate(["/annual-statements"]),i.unread&&this.updateNotiAsRead(i)):(this.router.navigate(["/notification-details"],{state:{notification:i}}),i.unread&&this.updateNotiAsRead(i))}updateNotiAsRead(i){console.log("currentNoti.unread",i),i.unread=!1,this.detailsService.setNotificationRead(i.id).then(n=>{try{this.isShowingLoader=!1,n.responseJSON&&n.responseJSON.statusCode==f.OK&&(this.config.userInfo.unreadNoti=this.config.userInfo.unreadNoti-1,this.utils.publishSomeData({event:"UnreadNotiUpdated",data:this.config.userInfo.unreadNoti}))}catch(s){this.isShowingLoader=!1,this.canTryAgain=!0,this.errorMsg=this.translateService.instant("generic_msgs.server_err")}},n=>{this.isShowingLoader=!1,this.canTryAgain=!0,this.errorMsg=this.utils.handleServiceException(n)})}UpdatedeleteNotification(i){this.logger.trace("PUT USER Notification delete--start"),this.utils.showProgressLoader();let n=i.id;this.utils.isDeviceOnLine()?this.detailsService.setNotificationsDelete(n).then(s=>{try{if(this.utils.dissmisProgressLoader(),s.responseJSON&&s.responseJSON.statusCode==f.OK){this.errorMsg=s.responseJSON.userMessage,this.isSuccess=!0,i.unread&&(this.config.userInfo.unreadNoti=this.config.userInfo.unreadNoti-1,this.utils.publishSomeData({event:"UnreadNotiUpdated",data:this.config.userInfo.unreadNoti}));const c=this.notifications.findIndex(l=>l.id===i.id);this.notifications.splice(c,1)}else s.responseJSON&&s.responseJSON.statusCode==f.yI?this.errorMsg=s.responseJSON.userMessage:(this.logger.error("PUT USER Notification delete Update : "+JSON.stringify(s)),this.errorMsg=this.translateService.instant("generic_msgs.server_err"),this.isSuccess=!1)}catch(c){this.utils.dissmisProgressLoader(),this.isSuccess=!1,this.logger.error("PUT USER Notification delete Update : "+JSON.stringify(c)),this.errorMsg=this.translateService.instant("generic_msgs.server_err")}},s=>{this.utils.dissmisProgressLoader(),this.isSuccess=!1,this.logger.error("PUT USER Notification delete Update : "+JSON.stringify(s)),this.errorMsg=this.utils.handleServiceException(s)}):(this.isShowingLoader=!1,this.isSuccess=!1,this.errorMsg=this.translateService.instant("generic_msgs.network_err"))}setDay(i){return this.sday=i.split("-",3),this.sday[0]}setMonth(i){return this.smonth=i.split("-",3),this.month_names_short[this.smonth[1]-1]}setYear(i){return this.syear=i.split("-",3),this.syear[2]}openLink(i){null!=i&&null!=i&&this.utils.openLink(i)}getMoreNotifications(i){this.loadMoreTimer&&clearTimeout(this.loadMoreTimer),this.loadMoreTimer=setTimeout(()=>{this.logger.trace("NotificationsPage --getMoreNotifications--start--infinite : "+i),this.isServiceCallInProgress||this.getNotifications(i),this.logger.trace("NotificationsPage--getMoreNotifications--end"),this.loadMoreTimer=null},800)}askToDelete(i,n){this.alertCtrl.create({header:"Notification",message:this.translateService.instant("notifications_page.deleteConfirmMsg"),buttons:[{text:"No",handler:()=>{console.log("Cancel clicked"),i.close()}},{text:"Yes",handler:()=>{this.UpdatedeleteNotification(n)}}]}).then(c=>c.present())}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(h.F0),t.Y36(N.J),t.Y36(o._q),t.Y36(P.f),t.Y36(d.i),t.Y36(S.g),t.Y36(M.w),t.Y36(u.sK),t.Y36(v.U),t.Y36(o.t4),t.Y36(t.sBO),t.Y36(o.Br))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-notifications"]],decls:10,vars:6,consts:[["mode","ios"],["color","primary",1,"toolbar"],["slot","start","auto-hide","false","color","secondary"],[1,"bold-font"],["padding","","no-bounce","",1,"app_bg2"],["class","spinnersection ion-text-center",4,"ngIf"],["class","errorMsgSection white_container_border_radius",4,"ngIf"],["class","text_color_base padding_015",4,"ngIf"],[1,"spinnersection","ion-text-center"],["name","lines-sharp-small",2,"height","98%"],[1,"errorMsgSection","white_container_border_radius"],["style","--background:var(--ion-color-white);",3,"click",4,"ngIf"],[2,"--background","var(--ion-color-white)",3,"click"],[1,"text_color_base","padding_015"],[2,"background","transparent !important"],["style","background: transparent !important",4,"ngFor","ngForOf"],[3,"ionInfinite",4,"ngIf"],["slidingItem",""],["detail","","lines","none",3,"ngClass","click"],[1,"NotiRow"],["size","3",1,"margin_top_bottom_auto","dateBlock"],[1,"font_size_18"],["size","8",1,"margin_top_bottom_auto","font_size_18",2,"text-align","justify","white-space","initial !important",3,"ngClass"],["slot","end"],[1,"deleteBtn","danger",3,"click"],["name","trash"],[2,"display","block"],[3,"ionInfinite"]],template:function(i,n){1&i&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1),t._UZ(2,"ion-menu-button",2),t.TgZ(3,"ion-title",3),t._uU(4),t.ALo(5,"translate"),t.qZA()()(),t.TgZ(6,"ion-content",4),t.YNc(7,C,2,0,"section",5),t.YNc(8,y,4,2,"section",6),t.YNc(9,Z,4,2,"div",7),t.qZA()),2&i&&(t.xp6(4),t.hij(" ",t.lcZ(5,4,"notifications_page.title")," "),t.xp6(3),t.Q6J("ngIf",n.isShowingLoader),t.xp6(1),t.Q6J("ngIf",!(n.notifications.length>0||n.isShowingLoader)),t.xp6(1),t.Q6J("ngIf",n.notifications.length>0))},dependencies:[g.mk,g.sg,g.O5,o.YG,o.wI,o.W2,o.Gu,o.gu,o.ju,o.MB,o.Ie,o.IK,o.td,o.Q$,o.q_,o.fG,o.Nd,o.PQ,o.wd,o.sr,u.X$],styles:[".label[_ngcontent-%COMP%]{margin:0!important;width:100%!important;padding:5px;white-space:nowrap!important}ion-padding[_ngcontent-%COMP%]{padding-top:none!important}.card[_ngcontent-%COMP%]{background:rgba(255,255,255,.7)!important;border-radius:15px}.NotiRow[_ngcontent-%COMP%]{height:110px}.dateBlock[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Agenda-Regular;font-size:2.3rem!important;text-align:center;color:var(--ion-color-secondary);margin-top:15px;line-height:24px;margin-bottom:10px}.customCardUnread[_ngcontent-%COMP%]{height:110px;background:#f3f5f6!important;border-radius:15px;width:calc(100% - 20px);font-size:1.4rem;box-shadow:0 2px 2px rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px rgba(0,0,0,.12);display:block;overflow:hidden;font-family:Agenda-Regular;font-weight:400;margin:5px 5px 5px 3%}.customCardRead[_ngcontent-%COMP%]{height:110px;background:#ffffff!important;border-radius:15px;width:calc(100% - 20px);font-size:1.4rem;box-shadow:0 2px 2px rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px rgba(0,0,0,.12);display:block;overflow:hidden;font-family:Agenda-Regular;font-weight:400;margin:5px 5px 5px 3%}.list-md[_ngcontent-%COMP%]   ion-item-options[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin:auto;border-radius:0;display:inline-flex;align-items:center;height:60%}.list-md[_ngcontent-%COMP%]   ion-item-options[_ngcontent-%COMP%]{border-bottom:none}.list-ios[_ngcontent-%COMP%]   ion-item-options[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin:auto;--border-radius: 0px !important;height:65%;min-height:60%}.spinnersection[_ngcontent-%COMP%]{display:block;flex-direction:column;justify-content:center;align-items:center;font-size:1.3rem;height:98%}.errorMsgSection[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:98%;font-size:.8rem;color:#494747!important;padding:0 15px}.UnreadNotification[_ngcontent-%COMP%]{font-weight:700}.deleteBtn[_ngcontent-%COMP%]{margin-right:5%!important}@media only screen and (max-width: 374px){p[_ngcontent-%COMP%], .col.font_size_18[_ngcontent-%COMP%]{font-size:17px!important}}@media only screen and (max-width: 320px){p[_ngcontent-%COMP%], .col.font_size_18[_ngcontent-%COMP%]{font-size:15px!important}}.danger[_ngcontent-%COMP%]{color:var(--ion-color-secondary-contrast)!important;--background: var(--ion-color-danger) !important}.padding_015[_ngcontent-%COMP%]{padding:0 18px}.margin_top_bottom_auto[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}ion-item[_ngcontent-%COMP%]{--detail-icon-color:black;--detail-icon-opacity: black}ion-button[_ngcontent-%COMP%]   .button-inner[_ngcontent-%COMP%]{flex-flow:column}.font_size_18[_ngcontent-%COMP%]{font-size:1.1rem!important}"]}),e})()}];let U=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[h.Bz.forChild(A),h.Bz]}),e})(),J=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.ez,_.u5,o.Pc,U,u.aw]}),e})()}}]);