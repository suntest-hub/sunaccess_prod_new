"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6838],{26838:(tt,f,a)=>{a.r(f),a.d(f,{ResetPwdWithPersonalDetailsPageModule:()=>H});var d=a(36895),r=a(24006),h=a(54463),i=a(48058),m=a(64228),v=a(15861),x=a(65414),w=a(97716),y=a(22727),t=a(98274),O=a(45340),Z=a(53025),C=a(9999),M=a(43485),S=a(81770),b=a(71959),N=a(25171);function A(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"img",18),t.NdJ("click",function(c){t.CHM(e);const g=t.oxw(2);return t.KtG(g.openPopup(c))}),t.qZA()}}function D(n,o){1&n&&(t.TgZ(0,"div",19)(1,"span",20),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"identitynumberisrequired"),""))}function T(n,o){1&n&&(t.TgZ(0,"div",19)(1,"span",20),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"Signup.identityNoLength_req"),""))}function F(n,o){1&n&&(t.TgZ(0,"div",19)(1,"span",20),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"policynumberisrequired"),""))}function q(n,o){1&n&&(t.TgZ(0,"div",19)(1,"span",20),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"Signup.policyNoLength_req"),""))}function L(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"ion-button",21),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.personalDetailscheck())}),t._uU(1,"Proceed"),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",!e.personalDetailsForm.controls.identityNumber.valid||!e.personalDetailsForm.controls.policyNo.valid)}}function I(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"form",8)(1,"p",9),t._uU(2),t.ALo(3,"translate"),t.YNc(4,A,1,0,"img",10),t.qZA(),t.TgZ(5,"ion-item",11),t._UZ(6,"ion-input",12),t.qZA(),t.YNc(7,D,4,3,"div",13),t.YNc(8,T,4,3,"div",13),t.TgZ(9,"p",14),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"ion-item",11),t._UZ(13,"ion-input",15),t.qZA(),t.YNc(14,F,4,3,"div",13),t.YNc(15,q,4,3,"div",13),t.TgZ(16,"ion-label",16),t.NdJ("click",function(){t.CHM(e);const c=t.oxw();return t.KtG(c.forgotPolicyNumber())}),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"ion-row"),t.YNc(20,L,2,1,"ion-button",17),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.personalDetailsForm),t.xp6(2),t.hij(" ",t.lcZ(3,10,"identitynumber")," "),t.xp6(2),t.Q6J("ngIf",!e.isValidUser),t.xp6(3),t.Q6J("ngIf",e.personalDetailsForm.get("identityNumber").hasError("required")&&e.personalDetailsForm.get("identityNumber").touched),t.xp6(1),t.Q6J("ngIf",e.personalDetailsForm.get("identityNumber").hasError("minlength")&&e.personalDetailsForm.get("identityNumber").touched),t.xp6(2),t.hij(" ",t.lcZ(11,12,"policycontractnumber"),""),t.xp6(4),t.Q6J("ngIf",e.personalDetailsForm.get("policyNo").hasError("required")&&e.personalDetailsForm.get("policyNo").touched),t.xp6(1),t.Q6J("ngIf",e.personalDetailsForm.get("policyNo").hasError("minlength")&&e.personalDetailsForm.get("policyNo").touched),t.xp6(2),t.Oqu(t.lcZ(18,14,"Signup.forgot_policy_text")),t.xp6(3),t.Q6J("ngIf",!e.isPersonalForm)}}function Q(n,o){1&n&&(t.TgZ(0,"section",22),t._UZ(1,"ion-spinner",23),t.qZA())}function R(n,o){if(1&n&&(t.TgZ(0,"ion-select-option",30),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.Q6J("value",e.type),t.xp6(1),t.Oqu(e.question)}}function J(n,o){1&n&&(t.TgZ(0,"div"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"selectsecretquestion")," "))}function W(n,o){if(1&n&&(t.TgZ(0,"ion-item",31),t.YNc(1,J,3,3,"div",7),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.SecretForm.get("securityQuestion").hasError("required")&&e.SecretForm.get("securityQuestion").touched)}}function k(n,o){1&n&&(t.TgZ(0,"div",19)(1,"span",20),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"secretquestionanswerrequired")))}function Y(n,o){1&n&&(t.TgZ(0,"div",19)(1,"span",20),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"seqAnsLength_req")))}function U(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"ion-button",21),t.NdJ("click",function(){t.CHM(e);const c=t.oxw(2);return t.KtG(c.secretQuestioncheck())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",!e.SecretForm.controls.securityQuestion.valid||!e.SecretForm.controls.answer.valid),t.xp6(1),t.Oqu(t.lcZ(2,2,"proceed"))}}const E=function(){return{cssClass:"mycomponent-wider-popover"}};function j(n,o){if(1&n&&(t.TgZ(0,"section")(1,"form",8)(2,"p",24),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"ion-list")(6,"ion-item",11)(7,"ion-select",25),t.YNc(8,R,2,2,"ion-select-option",26),t.qZA()()(),t.YNc(9,W,2,1,"ion-item",27),t.TgZ(10,"p",28),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"ion-item",11),t._UZ(14,"ion-input",29),t.ALo(15,"translate"),t.qZA(),t.YNc(16,k,4,3,"div",13),t.YNc(17,Y,4,3,"div",13),t.TgZ(18,"ion-row"),t.YNc(19,U,3,4,"ion-button",17),t.qZA()()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.SecretForm),t.xp6(2),t.Oqu(t.lcZ(4,11,"securityquestion")),t.xp6(4),t.Q6J("interfaceOptions",t.DdM(17,E))("selectOptions",e.selectOptions),t.xp6(1),t.Q6J("ngForOf",e.questions),t.xp6(1),t.Q6J("ngIf",e.SecretForm.get("securityQuestion").hasError("required")&&e.SecretForm.get("securityQuestion").touched),t.xp6(2),t.Oqu(t.lcZ(12,13,"securityanswer")),t.xp6(3),t.s9C("placeholder",t.lcZ(15,15,"securityanswerPlcHldr")),t.xp6(2),t.Q6J("ngIf",e.SecretForm.get("answer").hasError("required")&&e.SecretForm.get("answer").touched),t.xp6(1),t.Q6J("ngIf",e.SecretForm.get("answer").hasError("minlength")&&e.SecretForm.get("answer").touched),t.xp6(2),t.Q6J("ngIf",!e.isSecretForm)}}const z=[{path:"",component:(()=>{class n{constructor(e,s,c,g,u,P,B,K,V,X,$){this.translate=e,this.translateConfigService=s,this.utils=c,this.logger=g,this.popOverCtrl=u,this.config=P,this.forgotpasswordService=B,this.securityQuesService=K,this.signUpService=V,this.alertCtrl=X,this.router=$,this.str1="one",this.isShowingLoader=!0,this.requestForSecurityQuestions=function(){if(this.utils.isDeviceOnLine())this.securityQuesService.getSecurityQuestions().then(p=>{this.questions=p.responseJSON.array,this.SecretForm.controls.securityQuestion.setValue(this.questions[0].Type,{onlySelf:!0}),this.isShowingLoader=!1},p=>{this.isShowingLoader=!1});else{let p=this.translate.instant("generic_msgs.network_err");this.utils.showAlert("",p)}},this.personalDetailscheck=function(){if(this.utils.isDeviceOnLine()){var p=this.personalDetailsForm.controls.identityNumber.value,_=this.personalDetailsForm.controls.policyNo.value;this.utils.showProgressLoader(),this.forgotpasswordService.resetPasswordPersonal(this.email,p,_).then(l=>{this.serviceSuccess(l)},l=>{this.serviceFailed(l)})}else{let l=this.translate.instant("generic_msgs.network_err");this.utils.showAlert("",l)}},this.secretQuestioncheck=function(){if(this.utils.isDeviceOnLine()){var p=this.SecretForm.controls.securityQuestion.value,_=this.SecretForm.controls.answer.value;this.utils.showProgressLoader(),this.forgotpasswordService.resetPasswordSecret(this.email,p,_).then(l=>{this.serviceSuccess(l)},l=>{this.serviceFailed(l)})}else{let l=this.translate.instant("generic_msgs.network_err");this.utils.showAlert("",l)}},this.selectedLanguage=this.translateConfigService.getDefaultLanguage(),this.translateConfigService.setLanguage("en"),this.email=history.state.email,this.isSecret=history.state.isSecret,this.selectOptions={cssClass:"selectPopover-forgotPassword"},console.log("this.isSecret",this.isSecret)}ngOnInit(){this.personalDetailsForm=new r.cw({identityNumber:new r.NI("",[r.kI.required,r.kI.minLength(3)]),policyNo:new r.NI("",[r.kI.required,r.kI.minLength(3)])}),this.SecretForm=new r.cw({securityQuestion:new r.NI("",[r.kI.required]),answer:new r.NI("",[r.kI.required,r.kI.minLength(1)])}),this.logger.log("ionViewDidLoad ResetPwdWithPersonalDetailsPage"),this.isSecret&&this.requestForSecurityQuestions()}ionViewWillEnter(){this.utils.component.emit(x.c.FORGOT_PASSWORD)}openPopup(e){var s=this;return(0,v.Z)(function*(){yield(yield s.popOverCtrl.create({component:w.j,showBackdrop:!1,event:e,componentProps:{msg:s.str1,cssClass:"custom-popover"},cssClass:"custom-popover"})).present()})()}serviceSuccess(e){try{this.utils.dissmisProgressLoader(),this.utils.showAlert("",e.responseJSON.userMessage),this.router.navigate(["/login-first"])}catch(s){this.utils.dissmisProgressLoader();let c=this.translate.instant("generic_msgs.server_err");this.utils.showAlert("",c)}}serviceFailed(e){this.utils.dissmisProgressLoader();let s=this.utils.handleServiceException(e);this.utils.showAlert("",s)}forgotPolicyNumber(){var e=this.personalDetailsForm.controls.identityNumber.value;if(e){if(e.length>2){this.utils.showProgressLoader();var c="AOS";"ios"==this.utils.getPlatform()&&(c="IOS"),this.signUpService.postForgotPolicyNumber(e,!0,c).then(g=>{try{g.responseJSON&&g.responseJSON.statusCode==y.yI&&(this.errorMsg=g.responseJSON.userMessage,this.utils.dissmisProgressLoader(),this.utils.showAlert("",this.errorMsg))}catch(u){this.utils.dissmisProgressLoader();let P=this.translate.instant("generic_msgs.server_err");this.utils.showAlert("",P)}},g=>{this.utils.dissmisProgressLoader();let u=this.utils.handleServiceException(g);this.utils.showAlert("",u)})}}else this.errorMsg=this.translate.instant("Signup.identityNo_req"),this.utils.showAlert("",this.errorMsg)}showDialog(e,s){this.alertCtrl.create({header:e,message:s,buttons:[{text:"Ok",handler:()=>{}}],backdropDismiss:!1}).then(u=>u.present())}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.sK),t.Y36(O.w),t.Y36(Z.f),t.Y36(C.U),t.Y36(i.Dh),t.Y36(M.i),t.Y36(S.L),t.Y36(b.z),t.Y36(N.i),t.Y36(i.Br),t.Y36(m.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-reset-pwd-with-personal-details"]],decls:11,vars:6,consts:[["mode","ios"],["color","primary"],["slot","start"],["text","","icon","chevron-back-outline",2,"padding-left","15px","font-size","0.7rem"],["no-bounce","",1,"app_bg1","text_color_base","ion-padding"],["class","white_container_border_radius ion-padding",3,"formGroup",4,"ngIf"],["class","spinnersection",4,"ngIf"],[4,"ngIf"],[1,"white_container_border_radius","ion-padding",3,"formGroup"],[2,"margin-bottom","10px"],["src","../../../assets/imgs/circle-question-solid.svg","alt","...","style","width: 20px; float: right;",3,"click",4,"ngIf"],["lines","none",1,"border"],["type","text","placeholder","New NRIC/Other Identification","restrict-input","","restrictInput","alphanumeric","amaxlength","40","formControlName","identityNumber"],["class","errPosition",4,"ngIf"],["stacked","",2,"padding-top","10px","margin-bottom","10px"],["type","text","placeholder","Policy /contract /Certificate Number","restrict-input","","restrictInput","alphanumeric","restrict-input","","restrictInput","alphanumeric","amaxlength","40","formControlName","policyNo"],[1,"forgotPolicyLink",3,"click"],["ion-button","","class","btn_center",3,"disabled","click",4,"ngIf"],["src","../../../assets/imgs/circle-question-solid.svg","alt","...",2,"width","20px","float","right",3,"click"],[1,"errPosition"],[1,"mandatory_star"],["ion-button","",1,"btn_center",3,"disabled","click"],[1,"spinnersection"],["name","ios-small"],[2,"margin-bottom","0px"],["placeholder","Select The Security Question","mode","ios","interface","popover","formControlName","securityQuestion","select-option","",3,"interfaceOptions","selectOptions"],[3,"value",4,"ngFor","ngForOf"],["lines","none",4,"ngIf"],["stacked","",2,"margin-bottom","10px"],["type","text","restrict-input","","restrictInput","alphanumericwithspace","amaxlength","50","formControlName","answer",3,"placeholder"],[3,"value"],["lines","none"]],template:function(e,s){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),t._UZ(3,"ion-back-button",3),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.ALo(6,"translate"),t.qZA()()(),t.TgZ(7,"ion-content",4),t.YNc(8,I,21,16,"form",5),t.YNc(9,Q,2,0,"section",6),t.YNc(10,j,20,18,"section",7),t.qZA()),2&e&&(t.xp6(5),t.Oqu(t.lcZ(6,4,"forgotpassword")),t.xp6(3),t.Q6J("ngIf",!s.isSecret),t.xp6(1),t.Q6J("ngIf",s.isSecret&&s.isShowingLoader),t.xp6(1),t.Q6J("ngIf",s.isSecret&&!s.isShowingLoader))},dependencies:[d.sg,d.O5,r._Y,r.JJ,r.JL,i.oU,i.YG,i.Sm,i.W2,i.Gu,i.pK,i.Ie,i.Q$,i.q_,i.Nd,i.t9,i.n0,i.PQ,i.wd,i.sr,i.QI,i.j9,i.cs,r.sg,r.u,h.X$],styles:["ion-content[_ngcontent-%COMP%]{--background: url(/../assets/imgs/register_bg.jpg) no-repeat center center / cover}ion-content[_ngcontent-%COMP%]   .text_color_base[_ngcontent-%COMP%]{color:--ion-color-secondary!important}ion-content[_ngcontent-%COMP%]   .white_container_border_radius[_ngcontent-%COMP%]{background-color:rgba(255,255,255,.7)!important;border-radius:15px!important}ion-content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{padding-left:0;background:transparent}ion-content[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-input.ng-valid.item-input-has-value[_ngcontent-%COMP%]:not(.input-has-focus):not(.item-input-has-focus)   .item-inner[_ngcontent-%COMP%], ion-content[_ngcontent-%COMP%]   .item.item-input.ng-valid.input-has-value[_ngcontent-%COMP%]:not(.input-has-focus):not(.item-input-has-focus)   .item-inner[_ngcontent-%COMP%]{border-bottom-color:none!important;box-shadow:none!important}ion-content[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%]{padding-right:0!important;border-bottom:none!important}ion-content[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{border:1px solid #eee;padding:3px 15px;background:white}ion-content[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:1.7rem!important;color:--ion-color-secondary!important;margin-bottom:5px!important}ion-content[_ngcontent-%COMP%]   .question[_ngcontent-%COMP%]{text-align:right;float:right;font-size:1.3rem}ion-content[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{float:right!important;padding:5px;font-size:.85em}ion-content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-top:10px}ion-content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-family:Agenda-Regular;color:--ion-color-secondary;font-size:17px;margin-bottom:5px;margin-top:10px;line-height:1.42857143}ion-content[_ngcontent-%COMP%]   .forgotPolicyLink[_ngcontent-%COMP%]{font-size:1rem!important;margin-top:6px!important;text-decoration:underline;display:block;white-space:unset!important}ion-content[_ngcontent-%COMP%]   .mandatory_star[_ngcontent-%COMP%]{color:red}ion-content[_ngcontent-%COMP%]   .errPosition[_ngcontent-%COMP%]{margin-top:4px}ion-content[_ngcontent-%COMP%]   .btn_center[_ngcontent-%COMP%]{text-transform:capitalize;--background: #002d3d !important;color:#fff;margin-top:15px;--border-radius: 10px;min-height:40px;width:100%!important;font-family:Agenda-Regular!important}ion-content[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--placeholder-capacity: 2;width:100%!important;justify-content:center}ion-content[_ngcontent-%COMP%]   ion-popover[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{--width:400px}ion-content[_ngcontent-%COMP%]   .p[_ngcontent-%COMP%]{padding-top:10px;margin-bottom:5px}.mycomponent-wider-popover[_ngcontent-%COMP%]{--min-width: 340px !important}.mycomponent-wider-popover[_ngcontent-%COMP%]   .ion-select-popover[_ngcontent-%COMP%]{position:fixed;width:80%}.custom-popover[_ngcontent-%COMP%]   .popover-content[_ngcontent-%COMP%]{width:200px!important;border-radius:6px;border:1px solid rgba(0,0,0,.2);color:#002d3d;background-color:#e5eaeb!important;font-size:13px;margin-top:1.6em;text-align:center;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;--margin-left: -15px;box-shadow:0 5px 10px rgba(0,0,0,.2)}"]}),n})()}];let G=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.Bz.forChild(z),m.Bz]}),n})(),H=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez,r.u5,h.aw,i.Pc,r.UX,G]}),n})()}}]);