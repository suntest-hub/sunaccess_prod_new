"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7238],{97238:(y,v,r)=>{r.r(v),r.d(v,{TacPopupPageModule:()=>O});var h=r(36895),C=r(24006),b=r(48058),d=r(64228),T=r(41729),g=r(98274);const A=[{path:"",component:T.O}];let p=(()=>{class l{}return l.\u0275fac=function(f){return new(f||l)},l.\u0275mod=g.oAB({type:l}),l.\u0275inj=g.cJS({imports:[d.Bz.forChild(A),d.Bz]}),l})();var x=r(54463);let O=(()=>{class l{}return l.\u0275fac=function(f){return new(f||l)},l.\u0275mod=g.oAB({type:l}),l.\u0275inj=g.cJS({imports:[h.ez,C.u5,b.Pc,p,C.UX,x.aw]}),l})()},41729:(y,v,r)=>{r.d(v,{O:()=>R});var h=r(22727),C=r(50727);class b extends C.w0{constructor(s,e){super()}schedule(s,e=0){return this}}const d={setInterval(o,s,...e){const{delegate:t}=d;return null!=t&&t.setInterval?t.setInterval(o,s,...e):setInterval(o,s,...e)},clearInterval(o){const{delegate:s}=d;return((null==s?void 0:s.clearInterval)||clearInterval)(o)},delegate:void 0};var T=r(38737),A=r(26063);class p{constructor(s,e=p.now){this.schedulerActionCtor=s,this.now=e}schedule(s,e=0,t){return new this.schedulerActionCtor(this,s).schedule(t,e)}}p.now=A.l.now;const O=new class x extends p{constructor(s,e=p.now){super(s,e),this.actions=[],this._active=!1}flush(s){const{actions:e}=this;if(this._active)return void e.push(s);let t;this._active=!0;do{if(t=s.execute(s.state,s.delay))break}while(s=e.shift());if(this._active=!1,t){for(;s=e.shift();)s.unsubscribe();throw t}}}(class g extends b{constructor(s,e){super(s,e),this.scheduler=s,this.work=e,this.pending=!1}schedule(s,e=0){var t;if(this.closed)return this;this.state=s;const i=this.id,a=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(a,i,e)),this.pending=!0,this.delay=e,this.id=null!==(t=this.id)&&void 0!==t?t:this.requestAsyncId(a,this.id,e),this}requestAsyncId(s,e,t=0){return d.setInterval(s.flush.bind(s,this),t)}recycleAsyncId(s,e,t=0){if(null!=t&&this.delay===t&&!1===this.pending)return e;null!=e&&d.clearInterval(e)}execute(s,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const t=this._execute(s,e);if(t)return t;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(s,e){let i,t=!1;try{this.work(s)}catch(a){t=!0,i=a||new Error("Scheduled action threw falsy error")}if(t)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:s,scheduler:e}=this,{actions:t}=e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,T.P)(t,this),null!=s&&(this.id=this.recycleAsyncId(e,s,null)),this.delay=null,super.unsubscribe()}}}),l=O;var m=r(69751),f=r(93532);var u=r(24006),n=r(98274),c=r(48058),N=r(53025),w=r(91903),J=r(54463),L=r(43485),Z=r(26475),Y=r(36895);function D(o,s){if(1&o&&(n.TgZ(0,"div",14),n._uU(1),n.qZA()),2&o){const e=n.oxw();n.xp6(1),n.hij("",3-e.sendOtpCount," Attempt Left")}}let R=(()=>{class o{constructor(e,t,i,a,P,z,U,V,F,k){this.modalCtrl=e,this.utils=t,this.actionSheetCtrl=i,this.base64=a,this.alertCtrl=P,this.translate=z,this.config=U,this.UpdatePersonalService=V,this.formbuilder=F,this.modalController=k,this.tmerVAl="(60 Sec)",this.enableResend=!1,this.sendOtpCount=0,this.invalidAttemptCount=0,this.OTPSubmitForm=this.formbuilder.group({otpCode:["",[u.kI.required,u.kI.minLength(6)]]}),this.config.currentPage.pageName="TACPopupPage",this.phoneNumber=this.config.userInfo.contactNumber,this.maskedPhoneNumber=this.config.userInfo.maskedContactNumber}ngOnInit(){console.log("ionViewDidLoad TacPopupPage"),this.sendOTP()}verifyTAC(){if(this.OTPSubmitForm.valid)if(this.utils.isDeviceOnLine())this.utils.showProgressLoader(),this.UpdatePersonalService.verifyTAC(this.OTPSubmitForm.controls.otpCode.value).then(t=>{try{if(t.responseJSON)if(t.responseJSON.statusCode==h.yI||t.responseJSON.statusCode==h.OK)this.utils.dissmisProgressLoader(),this.modalController.dismiss({TACVarified:!0});else if(this.utils.dissmisProgressLoader(),t.responseJSON&&t.responseJSON.statusCode==h.xe)this.utils.showAlert("",t.responseJSON.userMessage),this.OTPSubmitForm.controls.otpCode.markAsDirty(),this.OTPSubmitForm.controls.otpCode.setValue("");else{let i=t.responseJSON.message||this.translate.instant("generic_msgs.server_err");this.utils.showAlert("",i)}}catch(i){this.utils.dissmisProgressLoader();let a=this.translate.instant("generic_msgs.server_err");this.utils.showAlert("",a)}},t=>{this.utils.dissmisProgressLoader();let i=this.utils.handleServiceException(t);this.utils.showAlert("",i)});else{let e=this.translate.instant("generic_msgs.network_err");this.utils.showAlert("",e)}}sendOTP(){if(this.utils.isDeviceOnLine()){this.utils.showProgressLoader();let e="AOS";"ios"==this.utils.getPlatform()&&(e="IOS"),this.UpdatePersonalService.sendTAC(e).then(t=>{try{if(t.responseJSON)if(t.responseJSON&&t.responseJSON.statusCode==h.OK)this.enableResend=!1,this.sendOtpCount++,this.sendOtpCount<3&&(this.tmerVAl="(60 Sec)",this.startTimer()),this.utils.dissmisProgressLoader();else{this.utils.dissmisProgressLoader();let i=t.responseJSON.message||this.translate.instant("generic_msgs.server_err");this.utils.showAlert("",i)}}catch(i){this.utils.dissmisProgressLoader();let a=this.translate.instant("generic_msgs.server_err");this.utils.showAlert("",a)}},t=>{this.utils.dissmisProgressLoader();let i=this.utils.handleServiceException(t);this.utils.showAlert("",i)})}else{let e=this.translate.instant("generic_msgs.network_err");this.utils.showAlert("",e)}}startTimer(){var t,e=60;this.OTPTimerSubs=function I(o=0,s=O){return o<0&&(o=0),function S(o=0,s,e=l){let t=-1;return null!=s&&((0,f.K)(s)?e=s:t=s),new m.y(i=>{let a=function M(o){return o instanceof Date&&!isNaN(o)}(o)?+o-e.now():o;a<0&&(a=0);let P=0;return e.schedule(function(){i.closed||(i.next(P++),0<=t?this.schedule(void 0,t):i.complete())},a)})}(o,o,s)}(1e3).subscribe(i=>{t=Math.floor(e),this.tmerVAl="("+(t=t<10?"0"+t:t)+" sec)",e>=1&&--e,0==e&&(this.enableResend=!0,this.tmerVAl="",this.OTPTimerSubs.unsubscribe())})}showDialog(e,t){this.alertCtrl.create({header:e,message:t,buttons:[{text:"Ok",handler:()=>{this.modalController.dismiss({TACVarified:!0})}}],backdropDismiss:!1}).then(P=>P.present())}closeModal(){this.modalController.dismiss()}}return o.\u0275fac=function(e){return new(e||o)(n.Y36(c.IN),n.Y36(N.f),n.Y36(c.BX),n.Y36(w.D),n.Y36(c.Br),n.Y36(J.sK),n.Y36(L.i),n.Y36(Z.Y),n.Y36(u.qu),n.Y36(c.IN))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-tac-popup"]],decls:22,vars:6,consts:[["mode","ios"],["color","primary",2,"text-align","center","padding-top","0px !important"],[1,"bold-font"],[1,"padding"],[1,"margin_bottom",3,"formGroup"],[1,"enter-otp-container"],[1,"border"],["type","text","restrict-input","","restrictInput","nricDigit","maxlength","6","formControlName","otpCode","placeholder","Enter OTP Number"],[1,"timer-container"],["ion-button","",1,"btn_center",3,"disabled","click"],["class","attempts-left",4,"ngIf"],["text-center","",1,"buttons-container"],["ion-button","",1,"btn_center1",3,"disabled","click"],["ion-button","",1,"btn_center",3,"click"],[1,"attempts-left"]],template:function(e,t){1&e&&(n.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-label",2),n._uU(3,"Enter OTP "),n.qZA()()(),n.TgZ(4,"ion-content")(5,"div",3)(6,"p"),n._uU(7),n.qZA(),n.TgZ(8,"form",4)(9,"div",5)(10,"ion-item",6),n._UZ(11,"ion-input",7),n.qZA(),n.TgZ(12,"div",8)(13,"ion-button",9),n.NdJ("click",function(){return t.sendOTP()}),n._uU(14),n.qZA(),n.YNc(15,D,2,1,"div",10),n.qZA()()()()(),n.TgZ(16,"ion-footer")(17,"div",11)(18,"ion-button",12),n.NdJ("click",function(){return t.verifyTAC()}),n._uU(19,"Submit "),n.qZA(),n.TgZ(20,"ion-button",13),n.NdJ("click",function(){return t.closeModal()}),n._uU(21,"Cancel "),n.qZA()()()),2&e&&(n.xp6(7),n.hij("A 6-digit one-time-pin (OTP) has been sent to your mobile phone number (",t.maskedPhoneNumber,") "),n.xp6(1),n.Q6J("formGroup",t.OTPSubmitForm),n.xp6(5),n.Q6J("disabled",!t.enableResend),n.xp6(1),n.hij("Resend ",t.tmerVAl," "),n.xp6(1),n.Q6J("ngIf",t.sendOtpCount>1),n.xp6(3),n.Q6J("disabled",!t.OTPSubmitForm.controls.otpCode.valid))},dependencies:[Y.O5,u._Y,u.JJ,u.JL,u.nD,c.YG,c.W2,c.fr,c.Gu,c.pK,c.Ie,c.Q$,c.sr,c.j9,u.sg,u.u],styles:["page-tac-popup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.6rem}page-tac-popup[_ngcontent-%COMP%]   .attempts-left[_ngcontent-%COMP%]{font:12px/16px var(--ion-font-family);margin-top:8px}page-tac-popup[_ngcontent-%COMP%]   .enter-otp-container[_ngcontent-%COMP%]{margin-bottom:16px}page-tac-popup[_ngcontent-%COMP%]   .enter-otp-container[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{padding-left:0}page-tac-popup[_ngcontent-%COMP%]   .enter-otp-container[_ngcontent-%COMP%]   .item-inner[_ngcontent-%COMP%]{border-bottom:0!important;padding-right:0!important}page-tac-popup[_ngcontent-%COMP%]   .enter-otp-container[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{border:1px solid #c8c7cc;padding:0 16px}page-tac-popup[_ngcontent-%COMP%]   .enter-otp-container[_ngcontent-%COMP%]   .timer-container[_ngcontent-%COMP%]{margin-top:16px}p[_ngcontent-%COMP%]{margin-top:25px;margin-bottom:1.1rem;font-size:1rem;font-family:Agenda-Regular}.btn_center[_ngcontent-%COMP%]{text-transform:capitalize;--background: #002d3d !important;color:#fff;margin-top:15px;--border-radius: 10px !important;min-width:200px;min-height:40px;width:100%!important;font-family:Agenda-Regular!important;font-size:1.05rem}.btn_center1[_ngcontent-%COMP%]{text-transform:capitalize;--background: #002d3d !important;color:#fff;margin-top:15px;--border-radius: 10px !important;min-width:200px;min-height:40px;width:100%!important;font-family:Agenda-Regular!important;margin-bottom:-5px;font-size:1.05rem}.bold-font[_ngcontent-%COMP%]{font-size:1rem;font-family:Agenda-Bold!important;text-align:center}.buttons-container[_ngcontent-%COMP%], .padding[_ngcontent-%COMP%]{padding:10px}.bold-font[_ngcontent-%COMP%]{font-family:var(--ion-font-agenda-semibold);text-align:center!important;font-size:1.3rem!important;color:#002d3d;text-overflow:unset;white-space:unset;font-weight:400!important}"]}),o})()}}]);